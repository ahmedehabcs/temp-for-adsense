import{r as s,u as j,j as e,a as w,k as N,n as S,c as K,o as P,v as A}from"./index-DXw_tCo4.js";import{I}from"./index-BjtekEm9.js";import{f as C}from"./formatKeys-Blap60VP.js";function E(a){const o=a.replace(/-----BEGIN PRIVATE KEY-----/g,"").replace(/-----END PRIVATE KEY-----/g,"").replace(/\s+/g,"");return Uint8Array.from(atob(o),r=>r.charCodeAt(0)).buffer}async function F(a,o){const n=E(a),r=await window.crypto.subtle.importKey("pkcs8",n,{name:"RSASSA-PKCS1-v1_5",hash:"SHA-256"},!1,["sign"]),i=new TextEncoder().encode(o),c=await window.crypto.subtle.sign("RSASSA-PKCS1-v1_5",r,i);return btoa(String.fromCharCode(...new Uint8Array(c)))}function z(){const a=s.useRef(null),o=s.useRef(null),[n,r]=s.useState(""),[l,i]=s.useState(!1),[c,u]=s.useState(!1),[p,d]=s.useState(!1),[v,m]=s.useState(!!window.localStorage.getItem("publicKey")),g=j(),b=async h=>{h.preventDefault();const x=a.current.value.trim();if(!x){r("Please enter your private key");return}let t=(window.localStorage.getItem("publicKey")||"").trim();if(!t){if(t=o.current.value.trim(),!t)return r("Please enter your public key");t=C(t)}i(!0),r("");try{const{challenge:f}=await P(t),y=await F(x,f);await A(t,y),window.localStorage.setItem("publicKey",t),m(!0),window.location.reload()}catch{r("Login failed. Please try again."),m(!1),localStorage.removeItem("publicKey")}finally{i(!1)}};return e.jsxs("section",{className:"min-h-screen grass-dark flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx(w,{}),e.jsxs("div",{className:"bg-[var(--color-surface)] rounded-2xl shadow-xl p-8 w-full max-w-md border border-[var(--color-border)] relative z-10 backdrop-blur-sm bg-opacity-90",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-[var(--color-main-bg)] flex items-center justify-center text-[var(--color-main)] mb-4",children:e.jsx(N,{size:28})}),e.jsx("h1",{className:"text-2xl font-bold text-[var(--color-text)]",children:"Welcome Back"}),e.jsx("p",{className:"text-[var(--color-text-light)] mt-1",children:"Enter your credentials to continue"})]}),n&&e.jsxs("div",{className:"mb-4 p-3 bg-[var(--color-error-bg)] rounded-lg flex items-center gap-2 animate-fade-in",children:[e.jsx(S,{className:"text-[var(--color-error)]",size:18}),e.jsx("p",{className:"text-sm text-[var(--color-error)]",children:n})]}),e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[!v&&e.jsx("div",{className:"group",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:o,type:"text",onFocus:()=>d(!0),onBlur:()=>d(!1),placeholder:" ",className:"w-full px-4 py-3 text-white rounded-xl text-sm border-0 ring-1 ring-[var(--color-border)] focus:ring-2 focus:ring-[var(--color-main)] focus:outline-none transition-all peer"}),e.jsx("label",{className:`absolute left-4 transition-all duration-200 pointer-events-none ${p||o.current?.value?"hidden":"top-3.5 text-sm text-[var(--color-text-light)]"} peer-focus:top-1 peer-focus:text-xs peer-focus:text-[var(--color-main)]`,children:"Public Key"})]})}),e.jsx("div",{className:"group",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:a,type:"text",onFocus:()=>{u(!0),r("")},onBlur:()=>u(!1),placeholder:" ",className:"w-full px-4 py-3 text-white rounded-xl text-sm border-0 ring-1 ring-[var(--color-border)] focus:ring-2 focus:ring-[var(--color-main)] focus:outline-none transition-all peer"}),e.jsx("label",{className:`absolute left-4 transition-all duration-200 pointer-events-none ${c||a.current?.value?"hidden":"top-3.5 text-sm text-[var(--color-text-light)]"} peer-focus:top-1 peer-focus:text-xs peer-focus:text-[var(--color-main)]`,children:"Private Key"})]})}),e.jsx("button",{type:"submit",disabled:l,className:`w-full py-3.5 rounded-xl bg-gradient-to-r from-[var(--color-main)] to-[var(--color-main-light)] text-white font-medium flex items-center justify-center gap-2 transition-all hover:from-[var(--color-main-hover)] hover:to-[var(--color-main)] ${l?"opacity-80 cursor-not-allowed":"hover:shadow-md"}`,children:l?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"animate-spin",size:18}),"Verifying..."]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{size:18}),"Continue"]})})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-[var(--color-border)] text-center text-sm text-[var(--color-text-light)]",children:e.jsxs("p",{children:["Don't have an account?"," ",e.jsx("button",{onClick:()=>g("/register"),className:"text-[var(--color-main)] hover:underline transition-colors",children:"Register"})]})})]})]})}export{z as default};
